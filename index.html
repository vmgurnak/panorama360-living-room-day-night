<!doctype html>
<html lang="ru">

<head>
   <meta charset="utf-8">
   <title>360 Panorama Day/Night Smooth</title>
   <meta name="viewport" content="width=device-width,initial-scale=1">
   <link rel="stylesheet" href="https://cdn.pannellum.org/2.5/pannellum.css" />
   <style>
      html,
      body {
         margin: 0;
         height: 100%;
         overflow: hidden;
         background: #000;
         touch-action: manipulation;
      }

      #panorama {
         width: 100%;
         height: 100vh;
      }

      /* Overlay для плавного изменения света */
      #lightOverlay {
         position: absolute;
         top: 0;
         left: 0;
         width: 100%;
         height: 100%;
         background: rgba(0, 0, 0, 0);
         /* прозрачный для дня */
         pointer-events: none;
         z-index: 15;
         transition: background 1.2s ease;
      }

      /* Правая панель */
      #controls {
         position: absolute;
         top: 50%;
         right: 10px;
         transform: translateY(-50%);
         display: flex;
         flex-direction: column;
         gap: 8px;
         background: rgba(0, 0, 0, 0.3);
         padding: 8px;
         border-radius: 8px;
         z-index: 20;
      }

      #controls button {
         background: rgba(255, 255, 255, 0.8);
         border: none;
         padding: 8px;
         border-radius: 4px;
         cursor: pointer;
         font-size: 16px;
         width: 44px;
         height: 44px;
         display: flex;
         align-items: center;
         justify-content: center;
      }

      #controls button:hover {
         background: rgba(255, 255, 255, 0.4);
         transform: scale(1.05);
      }

      #controls svg {
         width: 24px;
         height: 24px;
         fill: #000;
         display: block;
         margin: auto;
      }

      /* Панель День/Ночь слева */
      #dayNightControls {
         position: absolute;
         top: 10px;
         left: 10px;
         display: flex;
         flex-direction: column;
         gap: 8px;
         z-index: 20;
      }

      .dayNightControls button {
         width: 44px;
         height: 44px;
         background: rgba(255, 255, 255, 0.8);
         border: none;
         border-radius: 50%;
         cursor: pointer;
         display: flex;
         align-items: center;
         justify-content: center;
         transition: background 0.2s, transform 0.2s;
      }

      .dayNightControls button:hover {
         background: rgba(255, 255, 255, 1);
         transform: scale(1.05);
      }

      .dayNightControls svg {
         width: 22px;
         height: 22px;
         fill: #000;
      }

      @media (max-width: 768px) {

         #controls button,
         .dayNightControls button {
            width: 50px;
            height: 50px;
         }

         .dayNightControls svg {
            width: 24px;
            height: 24px;
         }
      }
   </style>
</head>

<body>
   <div id="panorama"></div>
   <div id="lightOverlay"></div>

   <!-- Правая панель -->
   <div id="controls">
      <button id="up" aria-label="Up">
         <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M7 14l5-5 5 5z" />
         </svg>
      </button>
      <button id="down" aria-label="Down">
         <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M7 10l5 5 5-5z" />
         </svg>
      </button>
      <button id="left" aria-label="Left">
         <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M14 7l-5 5 5 5z" />
         </svg>
      </button>
      <button id="right" aria-label="Right">
         <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M10 7l5 5-5 5z" />
         </svg>
      </button>
      <button id="zoomIn">＋</button>
      <button id="zoomOut">－</button>
      <button id="fs">⛶</button>
   </div>

   <!-- Панель День/Ночь -->
   <div id="dayNightControls" class="dayNightControls">
      <button id="dayBtn" title="Day">
         <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path
               d="M6.76 4.84l-1.8-1.79-1.41 1.41 1.79 1.8 1.42-1.42zm10.48 0l1.8-1.79 1.41 1.41-1.79 1.8-1.42-1.42zM12 4V1h-1v3h1zm0 19v-3h-1v3h1zm8-9h3v-1h-3v1zm-19 0h3v-1H1v1zm15.66 6.66l1.79 1.8 1.41-1.41-1.8-1.79-1.4 1.4zm-11.31 0l-1.8 1.8 1.41 1.41 1.8-1.8-1.41-1.41zM12 7a5 5 0 100 10 5 5 0 000-10z" />
         </svg>
      </button>
      <button id="nightBtn" title="Night">
         <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path
               d="M9.37 5.51A7 7 0 0012 19a7 7 0 006.49-9.16 0.5 0.5 0 01.72-.59A9 9 0 1111.1 4.79a0.5 0.5 0 01-.59.72c-.4.16-.78.36-1.14.6z" />
         </svg>
      </button>
   </div>

   <script src="https://cdn.pannellum.org/2.5/pannellum.js"></script>
   <script>
      const viewer = pannellum.viewer('panorama', {
         default: { firstScene: "day", hfov: 100, orientationOnByDefault: true, showControls: false, autoRotate: 0 },
         scenes: {
            day: { type: "equirectangular", panorama: "pano_day.webp", autoLoad: true },
            night: { type: "equirectangular", panorama: "pano_night.webp" }
         }
      });

      const overlay = document.getElementById('lightOverlay');

      // Функция плавного перехода освещения
      function switchLighting(scene) {
         if (scene === 'night') {
            overlay.style.background = 'rgba(0,0,50,0.35)'; // полутемно-синий
         } else {
            overlay.style.background = 'rgba(0,0,0,0)'; // день
         }
         setTimeout(() => viewer.loadScene(scene), 600);
      }

      // function addMobileClick(el, fn) {
      //    el.addEventListener('click', fn);
      //    el.addEventListener('touchstart', e => { e.preventDefault(); fn(); });
      // }

      function addMobileClick(el, fn) {
         el.addEventListener('click', fn);
         el.addEventListener('touchend', e => { e.preventDefault(); fn(); });
      }

      addMobileClick(document.getElementById('dayBtn'), () => switchLighting('day'));
      addMobileClick(document.getElementById('nightBtn'), () => switchLighting('night'));

      // Панель управления
      addMobileClick(document.getElementById('up'), () => viewer.setPitch(viewer.getPitch() - 10));
      addMobileClick(document.getElementById('down'), () => viewer.setPitch(viewer.getPitch() + 10));
      addMobileClick(document.getElementById('left'), () => viewer.setYaw(viewer.getYaw() - 10));
      addMobileClick(document.getElementById('right'), () => viewer.setYaw(viewer.getYaw() + 10));
      addMobileClick(document.getElementById('zoomIn'), () => viewer.setHfov(viewer.getHfov() - 10));
      addMobileClick(document.getElementById('zoomOut'), () => viewer.setHfov(viewer.getHfov() + 10));
      addMobileClick(document.getElementById('fs'), () => {
         if (!document.fullscreenElement) { document.documentElement.requestFullscreen(); }
         else { document.exitFullscreen(); }
      });
   </script>
</body>

</html>